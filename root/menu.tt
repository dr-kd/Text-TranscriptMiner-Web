[% MACRO render_menu(corpus) BLOCK  -%]
[% node = corpus.doctree; pathfinder = corpus.pathfinder %]
<ul class="sf-menu">
[% all_nodes(node) %]
[% END %]

[% MACRO all_nodes(node) BLOCK %]
[% render_submenu(node) %]
[%- END -%]

[%- MACRO render_submenu(node) BLOCK -%]
[%- FOREACH item IN node.getAllChildren -%]
[% SET visitor = item.accept(pathfinder) %]   <li> <a href="[% c.uri_for( 'docs', visitor.join('/') )%]"> [% item.getNodeValue %] </a> [% IF item.getAllChildren.size %] <ul> [% render_submenu(item) %] </ul> [% END %]  </li> 
[%- END -%]
[%- END -%]
</ul>

